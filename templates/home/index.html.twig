{% extends 'base.html.twig' %}

{% block title %}DA BOIT Maxence - Portfolio{% endblock %}

{% block stylesheets %}
<style>
    /* BENTO GRID SPECIFICS */
    .bento-grid {
        display: grid;
        grid-template-columns: repeat(12, 1fr);
        gap: 1.5rem;
        padding: 2rem 0;
        max-width: 1200px;
        margin: 0 auto;
    }

    .bento-card {
        background: var(--card-bg);
        border-radius: var(--radius);
        padding: 2.5rem;
        border: 1px solid rgba(0,0,0,0.03);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        overflow: hidden;
        position: relative;
    }
    
    .bento-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0,0,0,0.05); }

    .col-span-12 { grid-column: span 12; }
    .col-span-8 { grid-column: span 8; }
    .col-span-6 { grid-column: span 6; }
    .col-span-4 { grid-column: span 4; }

    @media (max-width: 968px) { .col-span-8, .col-span-6, .col-span-4 { grid-column: span 12; } }

    /* HERO TEXT */
    .big-title { font-size: clamp(2.5rem, 4.5vw, 4rem); font-weight: 800; line-height: 1.1; margin-bottom: 1.5rem; }
    .hacker-text { font-family: 'Courier New', monospace; cursor: pointer; }
    
    /* TECH STACK */
    .tech-stack-wrapper { overflow: hidden; width: 100%; padding: 1rem 0; mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent); }
    .tech-stack { display: flex; gap: 5rem; width: max-content; animation: infinite-scroll 40s linear infinite; }
    .tech-item img { height: 50px; width: auto; opacity: 0.6; filter: grayscale(100%); transition: 0.3s; }
    .tech-item img:hover { opacity: 1; filter: grayscale(0%); transform: scale(1.1); }
    @keyframes infinite-scroll { from { transform: translateX(0); } to { transform: translateX(-50%); } }

    /* --- DOSSIER (FOLDER) CSS --- */
    .folder-container { min-height: 500px; display: flex; align-items: center; justify-content: center; overflow: visible; }
    .folder { position: relative; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); cursor: pointer; transform: scale(3.0); }
    .folder:not(.open):hover { transform: scale(3.1) translateY(-5px); }
    .folder.open { transform: scale(3.1) translateY(-5px); }
    .folder__back { width: 100px; height: 80px; background: #4218CC; border-radius: 0 10px 10px 10px; position: relative; }
    .folder__back::after { position: absolute; bottom: 98%; left: 0; content: ''; width: 30px; height: 10px; background: #4218CC; border-radius: 5px 5px 0 0; }
    .folder__front { position: absolute; z-index: 3; width: 100%; height: 100%; background: #5227FF; border-radius: 5px 10px 10px 10px; transform-origin: bottom; transition: all 0.3s ease-in-out; }
    .folder.open .folder__front { transform: skew(15deg) scaleY(0.6); }

    .paper { 
        position: absolute; z-index: 2; bottom: 10%; left: 50%; 
        width: 70%; height: 80%; background: #fff; border-radius: 5px; 
        transition: 0.3s; transform: translate(-50%, 10%); 
        display: flex; flex-direction: column; text-decoration: none!important; 
        box-shadow: 0 2px 5px rgba(0,0,0,0.1); border: 1px solid rgba(0,0,0,0.05); 
    }
    .folder.open .paper:nth-child(1) { transform: translate(-120%, -70%) rotateZ(-15deg); }
    .folder.open .paper:nth-child(2) { transform: translate(10%, -70%) rotateZ(15deg); height: 80%; }
    .folder.open .paper:nth-child(3) { transform: translate(-50%, -100%) rotateZ(5deg); height: 80%; }
    
    .paper-img { width: 100%; height: 60%; background-size: cover; background-position: center; }
    .paper-info { flex-grow: 1; display: flex; align-items: center; justify-content: center; background: white; padding: 2px; }
    .paper-title { font-size: 6px; font-weight: bold; color: #333; margin: 0; text-align: center; }
    
    /* Passions */
    .passion-card { height: 160px; border-radius: 20px; position: relative; overflow: hidden; transition: transform 0.3s; cursor: pointer; display: block; margin-bottom: 1rem; }
    .passion-card:hover { transform: scale(1.02); }
    .passion-label { position: absolute; bottom: 1.5rem; left: 1.5rem; color: white; font-weight: 700; font-size: 1.2rem; text-shadow: 0 2px 10px rgba(0,0,0,0.1); }
</style>
{% endblock %}

{% block body %}
<div class="container-custom">
    <div class="bento-grid">
        
        {# 1. HERO #}
        <div class="bento-card col-span-8 d-flex flex-column justify-content-center">
            <p class="mb-2 text-secondary fw-bold">üëã Bonjour, je suis DA BOIT Maxence</p>
            <div class="big-title">
                <span class="d-block hacker-text" data-value="Etudiant">Etudiant</span>
                <span class="d-block" style="color: var(--accent-color);">BUT R√©seaux & T√©l√©coms</span>
            </div>
            <p class="text-secondary mb-4" style="max-width: 550px;">
                Passionn√© par la <strong>cybers√©curit√©</strong> et le <strong>d√©veloppement</strong>.
            </p>
            <div class="d-flex gap-3">
                <a href="{{ path('app_cv') }}" class="btn btn-dark rounded-pill">Voir mon CV</a>
                <a href="{{ path('app_contact') }}" class="btn btn-outline-dark rounded-pill">Me Contacter</a>
            </div>
        </div>

        {# 2. LOGO #}
        <div class="bento-card col-span-4 d-flex align-items-center justify-content-center" style="background: #e9ecef;">
            <img src="{{ asset('Image/IUT.ROANNE-LOGO-NOIR.png') }}" alt="IUT Logo" style="max-width: 360px; opacity: 0.8;">
        </div>

        {# 3. TECH STACK #}
        <div class="bento-card col-span-12 d-flex align-items-center p-0" style="overflow: hidden;">
            <div class="tech-stack-wrapper">
                <div class="tech-stack" id="techStack">
                    <div class="tech-item"><img src="{{ asset('Image/cisco.png') }}" alt="Cisco"></div>
                    <div class="tech-item"><img src="{{ asset('Image/python.png') }}" alt="Python"></div>
                    <div class="tech-item"><img src="{{ asset('Image/symfony.png') }}" alt="Symfony"></div>
                    <div class="tech-item"><img src="{{ asset('Image/ubuntu.png') }}" alt="Ubuntu"></div>
                </div>
            </div>
        </div>

        {# 4. LE DOSSIER INTERACTIF #}
        <div class="bento-card col-span-12 folder-container" style="background: #f1f3f5;">
            <div style="position: absolute; top: 2rem; left: 2rem; z-index: 1;">
                <h2>Projets R√©cents</h2>
                <p>Cliquez sur le dossier pour explorer</p>
            </div>

            <div class="folder" id="myFolder">
                <div class="folder__back">
                    {% for project in projects|slice(0, 3) %}
                        {% set configs = [{'x': '-120%', 'y': '-70%', 'r': '-15deg'}, {'x': '10%', 'y': '-70%', 'r': '15deg'}, {'x': '-50%', 'y': '-100%', 'r': '5deg'}] %}
                        {% set cfg = configs[loop.index0] %}
                        
                        {# LIEN VERS LE D√âTAIL DU PROJET #}
                        <a href="{{ path('app_project_detail', {id: project.id}) }}" class="paper" 
                            data-base-x="{{ cfg.x }}" data-base-y="{{ cfg.y }}" data-rotate="{{ cfg.r }}">
                            <div class="paper-img" style="background-image: url('{{ asset('Image/' ~ project.imageFilename) }}');"></div>
                            <div class="paper-info"><span class="paper-title">{{ project.title }}</span></div>
                        </a>
                    {% endfor %}
                    <div class="folder__front"></div>
                </div>
            </div>
            
            {# LIEN VERS TOUS LES PROJETS #}
            <a href="{{ path('app_eportfolio') }}" style="position: absolute; bottom: 2rem; right: 2rem;" class="btn btn-sm btn-outline-dark rounded-pill">Tout voir</a>
        </div>

        {# 5. PASSIONS #}
        <div class="bento-card col-span-6">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2>Mes Passions</h2>
                <a href="{{ path('app_passions') }}" class="small text-muted">Voir d√©tails ‚Üí</a>
            </div>
            <div class="row g-3">
                {# JAPONAIS (Passe en col-6) #}
                <div class="col-6">
                    <a href="{{ path('app_japanese') }}" class="passion-card" style="background: linear-gradient(135deg, #FF9A9E 0%, #FECFEF 100%);">
                        <span class="passion-label">Êó•Êú¨Ë™û</span>
                    </a>
                </div>
                
                {# LINUX (Passe en col-6) #}
                <div class="col-6">
                    <a href="{{ path('app_linux') }}" class="passion-card" style="background: linear-gradient(135deg, #1a1b26 0%, #000 100%);">
                        <span class="passion-label" style="color: #9ece6a;">Linux</span>
                    </a>
                </div>
            </div>
            {# PHOTOGRAPHIE #}
    <div class="col-6">
        <a href="{{ path('app_photographie') }}" class="passion-card" style="background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);">
            <span class="passion-label">Photo</span>
        </a>
    </div>
        </div>

        {# 6. PARCOURS #}
        <div class="bento-card col-span-6">
            <h2>Mon Parcours</h2>
            <div class="mt-4 d-flex flex-column gap-3">
                <div class="d-flex justify-content-between border-bottom pb-2">
                    <div><div class="fw-bold">BUT R&T</div><div class="small text-muted">IUT de Roanne</div></div>
                    <div class="text-end fw-bold text-muted">En cours</div>
                </div>

            <div class="d-flex justify-content-between border-bottom pb-2">
                    <div><div class="fw-bold">Menuisier Bois</div><div class="small text-muted">France D√©cors, Thizy</div></div>
                    <div class="text-end fw-bold text-muted">2021-2024</div>
                </div>

            <div class="d-flex justify-content-between border-bottom pb-2">
                    <div><div class="fw-bold">Pr√©parateur de commandes</div><div class="small text-muted">Intermarch√© / Les Mousquetaires, Reyrieux</div></div>
                    <div class="text-end fw-bold text-muted">2020-2021</div>
                </div>

                <div class="d-flex justify-content-between border-bottom pb-2">
                    <div><div class="fw-bold">Bac Pro SEN</div><div class="small text-muted">Lyc√©e Arago, Roanne</div></div>
                    <div class="text-end fw-bold text-muted">2016-2019</div>
                </div>
                <div class="d-flex justify-content-between border-bottom pb-2">
                    <div><div class="fw-bold">BEP SEN</div><div class="small text-muted">Lyc√©e Arago, Roanne</div></div>
                    <div class="text-end fw-bold text-muted">2016-2019</div>
                </div>
            </div>
        </div>

    </div> 
</div>
{% endblock %}

{% block javascripts %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- 1. DOSSIER ---
        const folder = document.getElementById('myFolder');
        if(folder) {
            const papers = folder.querySelectorAll('.paper');
            folder.addEventListener('click', (e) => {
                // IMPORTANT: Si clic sur feuille ouverte, on suit le lien
                if (folder.classList.contains('open') && e.target.closest('.paper')) return;
                const isOpen = folder.classList.toggle('open');
                if (!isOpen) {
                    papers.forEach(p => { p.style.transform = ''; p.style.zIndex = ''; });
                }
            });
            // Effet Magn√©tique
            papers.forEach(paper => {
                paper.addEventListener('mousemove', (e) => {
                    if (!folder.classList.contains('open')) return;
                    const rect = paper.getBoundingClientRect();
                    const offsetX = (e.clientX - (rect.left + rect.width/2)) * 0.3;
                    const offsetY = (e.clientY - (rect.top + rect.height/2)) * 0.3;
                    paper.style.transform = `translate(calc(${paper.dataset.baseX} + ${offsetX}px), calc(${paper.dataset.baseY} + ${offsetY}px)) rotateZ(${paper.dataset.rotate}) scale(1.1)`;
                    paper.style.zIndex = '10';
                });
                paper.addEventListener('mouseleave', () => {
                    if (folder.classList.contains('open')) {
                        paper.style.transform = `translate(${paper.dataset.baseX}, ${paper.dataset.baseY}) rotateZ(${paper.dataset.rotate})`;
                        paper.style.zIndex = '';
                    }
                });
            });
        }
        // --- 2. HACKER TEXT ---
        const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";
        document.querySelectorAll(".hacker-text").forEach(el => {
            const run = () => {
                let i = 0; const original = el.dataset.value;
                clearInterval(el.interval);
                el.interval = setInterval(() => {
                    el.innerText = original.split("").map((l, idx) => {
                        if(idx < i) return original[idx];
                        return chars[Math.floor(Math.random() * chars.length)];
                    }).join("");
                    if(i >= original.length) clearInterval(el.interval);
                    i += 1 / 2;
                }, 30);
            };
            el.onmouseover = run;
            run();
        });
        // --- 3. ANIMATION STACK ---
        const stack = document.getElementById('techStack');
        if (stack) stack.innerHTML += stack.innerHTML;
    });
</script>
{% endblock %}