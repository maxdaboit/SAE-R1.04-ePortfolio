{% extends 'base.html.twig' %}

{% block title %}DA BOIT Maxence - Portfolio{% endblock %}

{% block stylesheets %}
<style>
    /* --- 1. CONFIGURATION GLOBALE --- */
    :root {
        --bg-color: #ffffff;
        --card-bg: #f8f9fa;
        --accent-color: #5227FF;
        --text-primary: #111;
        --text-secondary: #666;
        --radius: 28px;
    }

    body {
        background-color: var(--bg-color);
        color: var(--text-primary);
        font-family: 'Inter', sans-serif;
    }

    /* --- 2. LA BENTO GRID --- */
    .bento-grid {
        display: grid;
        grid-template-columns: repeat(12, 1fr);
        gap: 1.5rem;
        padding: 2rem 0;
        max-width: 1200px;
        margin: 0 auto;
    }

    .bento-card {
        background: var(--card-bg);
        border-radius: var(--radius);
        padding: 2.5rem;
        border: 1px solid rgba(0,0,0,0.03);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        overflow: hidden;
        position: relative;
    }
    
    .bento-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        border-color: rgba(0,0,0,0.08);
    }

    .col-span-12 { grid-column: span 12; }
    .col-span-8 { grid-column: span 8; }
    .col-span-6 { grid-column: span 6; }
    .col-span-4 { grid-column: span 4; }

    @media (max-width: 968px) {
        .col-span-8, .col-span-6, .col-span-4 { grid-column: span 12; }
    }

    /* --- 3. CSS SP√âCIFIQUE HERO --- */
    .big-title {
        font-size: clamp(2.5rem, 4.5vw, 4rem);
        font-weight: 800;
        line-height: 1.1;
        letter-spacing: -0.03em;
        margin-bottom: 1.5rem;
    }

    .social-icon-btn {
        width: 50px; height: 50px; border-radius: 50%;
        background: #fff; border: 1px solid rgba(0,0,0,0.1);
        display: flex; align-items: center; justify-content: center;
        color: var(--text-primary); font-size: 1.4rem;
        transition: all 0.3s ease; text-decoration: none;
    }

    .social-icon-btn:hover {
        background: var(--text-primary); color: #fff;
        transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    /* --- 4. CSS LOGOS --- */
    .tech-stack-wrapper {
        overflow: hidden; width: 100%; padding: 1rem 0;
        mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
        -webkit-mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
    }
    .tech-stack {
        display: flex; gap: 5rem; width: max-content; align-items: center;
        animation: infinite-scroll 40s linear infinite;
    }
    .tech-stack:hover { animation-play-state: paused; }
    .tech-item img { height: 50px; width: auto; opacity: 0.6; transition: all 0.3s ease; filter: grayscale(100%); }
    .tech-item img:hover { opacity: 1; filter: grayscale(0%); transform: scale(1.1); }
    @keyframes infinite-scroll { from { transform: translateX(0); } to { transform: translateX(-50%); } }

    /* --- 5. CSS DOSSIER --- */
    .hacker-text { font-family: 'Courier New', monospace; cursor: pointer; }
    
    .folder-container {
        min-height: 500px;
        display: flex; align-items: center; justify-content: center;
        overflow: visible;
    }

    .folder {
        position: relative;
        transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        cursor: pointer;
        transform: scale(3.0);
    }
    
    .folder:not(.open):hover { transform: scale(3.1) translateY(-5px); }
    .folder.open { transform: scale(3.1) translateY(-5px); }

    /* Position OUVERTE */
    .folder.open .paper:nth-child(1) { transform: translate(-120%, -70%) rotateZ(-15deg); }
    .folder.open .paper:nth-child(2) { transform: translate(10%, -70%) rotateZ(15deg); height: 80%; }
    .folder.open .paper:nth-child(3) { transform: translate(-50%, -100%) rotateZ(5deg); height: 80%; }

    .folder__back { width: 100px; height: 80px; background: #4218CC; border-radius: 0 10px 10px 10px; position: relative; }
    .folder__back::after { position: absolute; bottom: 98%; left: 0; content: ''; width: 30px; height: 10px; background: #4218CC; border-radius: 5px 5px 0 0; }
    .folder__front { position: absolute; z-index: 3; width: 100%; height: 100%; background: #5227FF; border-radius: 5px 10px 10px 10px; transform-origin: bottom; transition: all 0.3s ease-in-out; }
    .folder.open .folder__front { transform: skew(15deg) scaleY(0.6); }

    /* Position FERM√âE (par d√©faut) - C'est ici que les papiers rentrent */
    .paper { 
        position: absolute; z-index: 2; bottom: 10%; left: 50%; 
        width: 70%; height: 80%; background: #fff; border-radius: 5px; 
        transition: 0.3s; 
        transform: translate(-50%, 10%); /* Position cach√©e */
        display: flex; flex-direction: column; text-decoration: none!important; 
        box-shadow: 0 2px 5px rgba(0,0,0,0.1); border: 1px solid rgba(0,0,0,0.05); 
    }
    
    .paper-img { width: 100%; height: 60%; background-size: cover; background-position: center; }
    .paper-info { flex-grow: 1; display: flex; align-items: center; justify-content: center; background: white; padding: 2px; }
    .paper-title { font-size: 6px; font-weight: bold; color: #333; margin: 0; text-align: center; }

    /* Styles divers */
    .tech-pill { display: inline-block; padding: 0.5rem 1rem; background: #fff; border-radius: 50px; font-size: 0.85rem; font-weight: 500; margin: 0 0.5rem 0.5rem 0; border: 1px solid rgba(0,0,0,0.05); }
    .passion-card { height: 160px; border-radius: 20px; background: linear-gradient(135deg, #eee 0%, #ddd 100%); position: relative; overflow: hidden; transition: transform 0.3s; cursor: pointer; display: block; margin-bottom: 1rem; }
    .passion-card:hover { transform: scale(1.02); }
    .gradient-1 { background: linear-gradient(135deg, #FF9A9E 0%, #FECFEF 100%); }
    .gradient-2 { background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); }
    .gradient-3 { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); }
    .passion-label { position: absolute; bottom: 1.5rem; left: 1.5rem; color: white; font-weight: 700; font-size: 1.2rem; text-shadow: 0 2px 10px rgba(0,0,0,0.1); }
</style>
{% endblock %}

{% block body %}

<div class="container-custom">
    
    <div class="bento-grid">
        
        {# --- 1. HERO CARD --- #}
        <div class="bento-card col-span-8 d-flex flex-column justify-content-center">
            <p class="mb-2 text-secondary fw-bold" style="font-size: 1.1rem;">
                üëã Bonjour, je suis DA BOIT Maxence
            </p>
            <div class="big-title">
                <span class="d-block hacker-text" data-value="Etudiant">Etudiant</span>
                <span class="d-block" style="color: var(--accent-color);">BUT R√©seaux & T√©l√©coms</span>
            </div>
            <p class="text-secondary mb-4" style="max-width: 550px; font-size: 1.1rem; line-height: 1.6;">
                Passionn√© par la <strong>cybers√©curit√©</strong> et le <strong>d√©veloppement</strong>. 
                Je transforme des infrastructures complexes en r√©seaux s√©curis√©s et performants.
            </p>
            <div class="d-flex gap-3">
                <a href="https://github.com/" target="_blank" class="social-icon-btn"><i class="fab fa-github"></i></a>
                <a href="https://linkedin.com/" target="_blank" class="social-icon-btn"><i class="fab fa-linkedin-in"></i></a>
                <a href="mailto:maxence.daboit@example.com" class="social-icon-btn"><i class="fas fa-envelope"></i></a>
                <a href="{{ path('app_cv') }}" class="social-icon-btn"><i class="fas fa-file-alt"></i></a>
            </div>
        </div>

        {# --- 2. LOGO CARD --- #}
        <div class="bento-card col-span-4 d-flex align-items-center justify-content-center" style="background: #e9ecef;">
            <div style="text-align: center;">
                <img src="{{ asset('Image/Image IUT/IUT.ROANNE-LOGO-NOIR.png') }}" alt="IUT Logo" style="max-width: 180px; opacity: 0.8;">
                <p class="mt-3 text-muted small">Groupe {{ groupe_tp|default('TP2') }}</p>
            </div>
        </div>

        {# --- 3. LOGOS QUI TOURNENT --- #}
        <div class="bento-card col-span-12 d-flex align-items-center p-0" style="overflow: hidden;">
            <div class="tech-stack-wrapper">
                <div class="tech-stack" id="techStack">
                    <div class="tech-item"><img src="{{ asset('Image/cisco.png') }}" alt="Cisco"></div>
                    <div class="tech-item"><img src="{{ asset('Image/c.png') }}" alt="C"></div>
                    <div class="tech-item"><img src="{{ asset('Image/python.png') }}" alt="Python"></div>
                    <div class="tech-item"><img src="{{ asset('Image/symfony.png') }}" alt="Symfony"></div>
                    <div class="tech-item"><img src="{{ asset('Image/html.png') }}" alt="HTML"></div>
                    <div class="tech-item"><img src="{{ asset('Image/css.png') }}" alt="CSS"></div>
                    <div class="tech-item"><img src="{{ asset('Image/ubuntu.png') }}" alt="Ubuntu"></div>
                </div>
            </div>
        </div>

        {# --- 4. LE PORTFOLIO (Dossier G√©ant) --- #}
        <div class="bento-card col-span-12 folder-container" style="background: #f1f3f5;">
            <div style="position: absolute; top: 2rem; left: 2rem; z-index: 1;">
                <h2>Projets R√©cents</h2>
                <p>Cliquez sur le dossier pour explorer</p>
            </div>

            <div class="folder" id="myFolder">
                <div class="folder__back">
                    {% for project in projects|slice(0, 3) %}
                        {% set configs = [
                            {'x': '-120%', 'y': '-70%', 'r': '-15deg'},
                            {'x': '10%', 'y': '-70%', 'r': '15deg'},
                            {'x': '-50%', 'y': '-100%', 'r': '5deg'}
                        ] %}
                        {% set cfg = configs[loop.index0] %}
                        <a href="{{ path('app_project_detail', {id: project.id}) }}" class="paper" 
                            data-base-x="{{ cfg.x }}" data-base-y="{{ cfg.y }}" data-rotate="{{ cfg.r }}">
                            <div class="paper-img" style="background-image: url('{{ asset('Image/' ~ project.imageFilename|default('symfony.png')) }}');"></div>
                            <div class="paper-info"><span class="paper-title">{{ project.title }}</span></div>
                        </a>
                    {% endfor %}
                    <div class="folder__front"></div>
                </div>
            </div>
            
            <a href="{{ path('app_eportfolio') }}" style="position: absolute; bottom: 2rem; right: 2rem;" class="btn btn-sm btn-outline-dark rounded-pill">Tout voir</a>
        </div>

        {# --- 5. PASSIONS --- #}
        <div class="bento-card col-span-6">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2>Ce qui m'anime</h2>
                <a href="{{ path('app_passions') }}" class="small text-muted">Voir d√©tails ‚Üí</a>
            </div>
            <div class="row g-3">
                <div class="col-4">
                    <a href="{{ path('app_passions') }}" class="passion-card gradient-1">
                        <span class="passion-label">Tech</span>
                    </a>
                </div>
                <div class="col-4">
                    <a href="{{ path('app_passions') }}" class="passion-card gradient-2">
                        <span class="passion-label">Dev</span>
                    </a>
                </div>
                <div class="col-4">
                    <a href="{{ path('app_passions') }}" class="passion-card gradient-3">
                        <span class="passion-label">Bois</span>
                    </a>
                </div>
            </div>
        </div>

        {# --- 6. PARCOURS --- #}
        <div class="bento-card col-span-6">
            <h2>Mon Parcours</h2>
            <div class="mt-4 d-flex flex-column gap-3">
                <div class="d-flex justify-content-between border-bottom pb-2">
                    <div>
                        <div class="fw-bold">BUT R&T</div>
                        <div class="small text-muted">IUT de Roanne</div>
                    </div>
                    <div class="text-end fw-bold text-muted">2023-25</div>
                </div>
                <div class="d-flex justify-content-between border-bottom pb-2">
                    <div>
                        <div class="fw-bold">CAP Menuiserie</div>
                        <div class="small text-muted">Artisanat</div>
                    </div>
                    <div class="text-end fw-bold text-muted">2020-22</div>
                </div>
                <div class="d-flex justify-content-between">
                    <div>
                        <div class="fw-bold">Bac Pro SEN</div>
                        <div class="small text-muted">Lyc√©e ARAGO</div>
                    </div>
                    <div class="text-end fw-bold text-muted">2016-19</div>
                </div>
            </div>
        </div>

    </div> </div>
{% endblock %}

{% block javascripts %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- 1. GESTION DU DOSSIER (CORRIG√âE) ---
        const folder = document.getElementById('myFolder');
        if(folder) {
            const papers = folder.querySelectorAll('.paper');
            
            folder.addEventListener('click', (e) => {
                // Si on clique sur un papier d√©j√† sorti pour suivre le lien, on ne fait rien
                if (folder.classList.contains('open') && e.target.closest('.paper')) return;
                
                // Bascule de la classe 'open'
                const isOpen = folder.classList.toggle('open');

                if (!isOpen) {
                    // C'EST ICI LE FIX : Si on ferme, on nettoie les styles inline (transform)
                    // pour que le CSS reprenne le contr√¥le et rentre les papiers.
                    papers.forEach(p => {
                        p.style.transform = '';
                        p.style.zIndex = '';
                    });
                }
            });

            // Effet Magn√©tique (souris)
            papers.forEach(paper => {
                paper.addEventListener('mousemove', (e) => {
                    // L'effet ne marche que si le dossier est OUVERT
                    if (!folder.classList.contains('open')) return;

                    const rect = paper.getBoundingClientRect();
                    const offsetX = (e.clientX - (rect.left + rect.width/2)) * 0.3;
                    const offsetY = (e.clientY - (rect.top + rect.height/2)) * 0.3;
                    
                    // On applique le mouvement + on garde la position ouverte (baseX)
                    paper.style.transform = `translate(calc(${paper.dataset.baseX} + ${offsetX}px), calc(${paper.dataset.baseY} + ${offsetY}px)) rotateZ(${paper.dataset.rotate}) scale(1.1)`;
                    paper.style.zIndex = '10'; // Met la carte survol√©e au premier plan
                });

                paper.addEventListener('mouseleave', () => {
                    // Quand la souris part, on remet √† la position ouverte normale
                    if (folder.classList.contains('open')) {
                        paper.style.transform = `translate(${paper.dataset.baseX}, ${paper.dataset.baseY}) rotateZ(${paper.dataset.rotate})`;
                        paper.style.zIndex = '';
                    }
                });
            });
        }

        // --- 2. Texte Hacker ---
        const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";
        document.querySelectorAll(".hacker-text").forEach(el => {
            const run = () => {
                let i = 0; const original = el.dataset.value;
                clearInterval(el.interval);
                el.interval = setInterval(() => {
                    el.innerText = original.split("").map((l, idx) => {
                        if(idx < i) return original[idx];
                        return chars[Math.floor(Math.random() * chars.length)];
                    }).join("");
                    if(i >= original.length) clearInterval(el.interval);
                    i += 1 / 2;
                }, 30);
            };
            el.onmouseover = run;
            run();
        });

        // --- 3. Animation Logos ---
        const stack = document.getElementById('techStack');
        if (stack) {
            const content = stack.innerHTML;
            stack.innerHTML = content + content;
        }
    });
</script>
{% endblock %}